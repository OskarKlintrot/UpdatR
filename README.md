<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /mdsource/README.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

[![build](https://github.com/OskarKlintrot/UpdatR/actions/workflows/build.yml/badge.svg)](https://github.com/OskarKlintrot/UpdatR/actions/workflows/build.yml) <!-- singleLineInclude: header. path: /mdsource/header.include.md -->

# UpdatR packages

## dotnet-updatr <!-- include: cli-readme. path: /mdsource/cli-readme.include.md -->

[![Latest Nuget Version](https://badgen.net/nuget/v/dotnet-updatr/latest)](https://www.nuget.org/packages/dotnet-updatr/)
[![Latest Nuget Version](https://badgen.net/nuget/dt/dotnet-updatr)](https://www.nuget.org/packages/dotnet-updatr/)

Dotnet tool for updating package reference and dotnet-tools.json.

The tool will try to stick to package versions that is supported by the projects target framework.

See [UpdatR](#updatr) for SDK.

### Installation

```
> dotnet tool install --global dotnet-updatr
```

### Basic Usage

To update all `*.csproj` and `dotnet-tools.json` recursivly:

```
> update
```

If you only want to update the `*.csproj` and `dotnet-tools.json` that is part of a solution you can specifiy the solution directly:

```
> update path/to/solution.sln
```

You can also update a single `*.csproj` or `dotnet-config.json`:

```
> update path/to/example.csproj
```

If you want to preview the result you can do a dry run:

```
> update --dry-run
```

For larger solutions with multiple packages the console output is not optimal. You can choose to view the result in your default browser instead:

```
> update --browser
```

If you don't want to update a package or packages you can exclude them:

```
> update --exclude-package Microsoft.* --exclude-package Newtonsoft.*
```

### As part of CI/CD

You can get the output as a markdown by setting a path for the output:

```
> update --output path/to/output/folder
```

It's possible to get the title and the rest of the output as separate .md-files which is helpful when creating a pull request:

```
> update --title path/to/title.md --description path/to/description.md
```

then you can use `title.md` as the title for your pull request and `description.md` as the body.

UpdatR is used to update it's own dependencies, have a look at [Build.cs](https://github.com/OskarKlintrot/UpdatR/blob/main/tools/Build/Build.cs) for an example that uses [Bullseye](https://www.nuget.org/packages/Bullseye) and [SimpleExec](https://www.nuget.org/packages/SimpleExec). However, if you are using C# in your CI/CD pipeline it's probably easier to just use [UpdatR](#updatr) directly instead. That's the package that powers `dotnet-updatr` under the hood.

### All options

<!-- snippet: cli-usage.txt -->
```txt
Usage:
  update [<args>] [options]

Arguments:
  <args>  Path to solution or project(s). Defaults to current folder. Target can be a specific file or folder. If target is a folder then all *.csproj-files and dontet-config.json-files will be processed. [default: .]

Options:
  --exclude-package <exclude-package>                                Package to exlude. Supports * as wildcard. []
  --output <output>                                                  Defaults to "output.md". Explicitly set to fileName.txt to generate plain text instead of markdown. []
  --title <title>                                                    Outputs title to path. []
  --description <description>                                        Outputs description to path. []
  --verbosity <Critical|Debug|Error|Information|None|Trace|Warning>  Log level. [default: Warning]
  --dry-run                                                          Do not save any changes. [default: False]
  --browser                                                          Open summary in browser. [default: False]
  --interactive                                                      Interaction with user is possible. [default: False]
  --version                                                          Show version information
  -?, -h, --help                                                     Show help and usage information
```
<!-- endSnippet -->
<!-- endInclude -->

## UpdatR <!-- include: sdk-readme. path: /mdsource/sdk-readme.include.md -->

[![Latest Nuget Version](https://badgen.net/nuget/v/UpdatR/latest)](https://www.nuget.org/packages/UpdatR/)
[![Latest Nuget Version](https://badgen.net/nuget/dt/UpdatR)](https://www.nuget.org/packages/UpdatR/)

NuGet package to programmatically update package reference and dotnet-tools.json.

The tool will try to stick to package versions that is supported by the projects target framework.

See [dotnet-updatr](#dotnet-updatr) for a dotnet tool that can be run from the command-line.

### Usage

<!-- snippet: SampleUsage -->
```cs
using UpdatR;
using UpdatR.Formatters;

var updatr = new Updater(); // Can take an ILogger

var summary = await updatr.UpdateAsync("path");

if (summary.UpdatedPackagesCount == 0) // No packages where updated
{
    return;
}

var title = MarkdownFormatter.GenerateTitle(summary);

var description = "# PR created automatically by UpdatR"
    + Environment.NewLine
    + Environment.NewLine
    + MarkdownFormatter.GenerateDescription(summary);

// Use title as title in the PR and description as the description/body in the PR
```
<!-- endSnippet -->
<!-- endInclude -->

# Icon <!-- include: footer. path: /mdsource/footer.include.md -->
Package by Sergey Novosyolov from [NounProject.com](http://NounProject.com) <!-- endInclude -->
